trigger:
- main

pool:
  vmImage: ubuntu-latest

stages:
- stage: Dev
  displayName: Dev Environment
  jobs:
  - job: BuildAndTest
    displayName: Build and Test
    steps:
    - task: DotNetCoreCLI@2
      inputs:
        command: build
    - task: DotNetCoreCLI@2
      inputs:
        command: test

- stage: DeployToDev
  displayName: Deploy to Dev Environment
  dependsOn: Dev
  jobs:
  - job: DeployToDev
    displayName: Deploy to Dev
    steps:
    - task: AzureRmWebAppDeployment@4
      inputs:
        azureSubscription: 'my-subscription-id'
        appType: webApp
        appName: 'my-webapp-name'
        package: '$(System.DefaultWorkingDirectory)/**/drop/my-webapp.zip'

